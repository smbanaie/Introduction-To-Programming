# ترتیب ارزیابی: کدام محاسبه اول انجام می‌شود؟

## چه چیزهایی یاد خواهید گرفت
- پایتون چگونه ترتیب محاسبات را تصمیم می‌گیرد
- چرا `2 + 3 * 4` برابر ۱۴ است (نه ۲۰)
- چگونه با پرانتز ترتیب را کنترل کنید
- قوانین چپ به راست در مقابل راست به چپ
- اشتباهات رایج و نحوه اجتناب از آن‌ها

---

## مفهوم اصلی: پیروی از قوانین

Imagine you're baking a cake. You can't put it in the oven before you mix the ingredients! Python has similar rules—it follows a specific order when solving math problems.

**مثال: قوانین راهنمایی و رانندگی**
مثل چراغ راهنمایی که به ماشین‌ها می‌گوید کی حرکت کنند، "ترتیب عملیات" پایتون هم به محاسبات می‌گوید کی اتفاق بیفتند.

---

## ترتیب عملیات (PEMDAS)

پایتون از PEMDAS پیروی می‌کند—مثل چیزی که در کلاس ریاضی یاد گرفتید:

| حرف | مخفف | نماد | مثال |
|------|------|--------|--------|
| **P** | پرانتز | `()` | `(2 + 3) * 4` |
| **E** | توان | `**` | `2 ** 3` |
| **MD** | ضرب/تقسیم | `*`, `/`, `//`, `%` | `5 * 3`, `10 / 2` |
| **AS** | جمع/تفریق | `+`, `-` | `5 + 3`, `10 - 2` |

**بعد از ریاضی:** مقایسه‌ها (`==`، `>`، `<` و غیره)، بعد عملگرهای منطقی (`and`، `or`)

### بیایید در عمل ببینیم

```python
# بدون پرانتز
نتیجه = 2 + 3 * 4
print(نتیجه)  # ۱۴، نه ۲۰!

# چرا؟ پایتون ابتدا ضرب را انجام می‌دهد:
# مرحله ۱: 3 * 4 = 12
# مرحله ۲: 2 + 12 = 14

# با پرانتز
نتیجه = (2 + 3) * 4
print(نتیجه)  # ۲۰

# پرانتز جمع را اول انجام می‌دهد:
# مرحله ۱: 2 + 3 = 5
# مرحله ۲: 5 * 4 = 20
```

---

## مثال‌های گام به گام

### مثال ۱: عملیات ترکیبی

```python
محاسبه = 10 + 5 * 2 - 3
# مرحله ۱ (ضرب): 5 * 2 = 10
# مرحله ۲ (جمع چپ به راست): 10 + 10 = 20
# مرحله ۳ (تفریق): 20 - 3 = 17
print(محاسبه)  # 17
```

### مثال ۲: با توان

```python
محاسبه = 2 + 3 ** 2 * 4
# مرحله ۱ (توان): 3 ** 2 = 9
# مرحله ۲ (ضرب): 9 * 4 = 36
# مرحله ۳ (جمع): 2 + 36 = 38
print(محاسبه)  # 38
```

### مثال ۳: عبارت پیچیده

```python
محاسبه = (10 - 2) * 3 + 8 / 4
# مرحله ۱ (پرانتز): 10 - 2 = 8
# مرحله ۲ (ضرب): 8 * 3 = 24
# مرحله ۳ (تقسیم): 8 / 4 = 2.0
# مرحله ۴ (جمع): 24 + 2.0 = 26.0
print(محاسبه)  # 26.0
```

---

## چپ به راست در مقابل راست به چپ

### اکثر عملیات: چپ به راست

وقتی عملگرها اولویت یکسانی دارند، پایتون از چپ به راست می‌رود:

```python
# جمع و تفریق (اولویت یکسان)
نتیجه = 20 - 10 + 5
# مرحله ۱: 20 - 10 = 10
# مرحله ۲: 10 + 5 = 15
print(نتیجه)  # 15

# ضرب و تقسیم (اولویت یکسان)
نتیجه = 100 / 10 * 2
# مرحله ۱: 100 / 10 = 10.0
# مرحله ۲: 10.0 * 2 = 20.0
print(نتیجه)  # 20.0
```

### استثنا: توان‌ها راست به چپ می‌روند

```python
# توان‌ها خاص هستند—راست به چپ می‌روند!
نتیجه = 2 ** 3 ** 2
# پایتون محاسبه می‌کند: 2 ** (3 ** 2) = 2 ** 9 = 512
# نه: (2 ** 3) ** 2 = 8 ** 2 = 64
print(نتیجه)  # 512

# برای وضوح از پرانتز استفاده کنید:
نتیجه = (2 ** 3) ** 2  # 64
print(نتیجه)
```

---

## مقایسه‌ها و عملگرهای منطقی

بعد از ریاضی، پایتون مقایسه‌ها و بعد عملگرهای منطقی را ارزیابی می‌کند:

### ترتیب: ریاضی → مقایسه‌ها → منطقی

```python
نتیجه = 5 + 3 > 7 and 10 - 2 < 15
# مرحله ۱ (ریاضی): 5 + 3 = 8، 10 - 2 = 8
# مرحله ۲ (مقایسه): 8 > 7 درست است، 8 < 15 درست است
# مرحله ۳ (منطقی): True and True = True
print(نتیجه)  # True
```

### NOT قبل از AND، AND قبل از OR

```python
نتیجه = not False and True or False
# مرحله ۱ (not): not False = True
# مرحله ۲ (and): True and True = True
# مرحله ۳ (or): True or False = True
print(نتیجه)  # True
```

---

## اشتباهات رایج مبتدی‌ها

### اشتباه ۱: انتظار چپ به راست برای همه عملیات

```python
# ❌ فرض اشتباه
نتیجه = 10 / 2 * 3  # نه (10 / 2) * 3 = 15
print(نتیجه)  # 15.0 - در واقع درست است!

# اما مراقب باشید:
نتیجه = 10 - 5 + 2  # نه 10 - (5 + 2) = 3
print(نتیجه)  # 7 - چپ به راست می‌رود
```

### اشتباه ۲: فراموش کردن راست به چپ بودن توان‌ها

```python
# ❌ گیج‌کننده
نتیجه = 2 ** 3 ** 2
print(نتیجه)  # 512، نه 64!

# ✅ برای وضوح از پرانتز استفاده کنید
نتیجه = 2 ** (3 ** 2)  # 512
نتیجه = (2 ** 3) ** 2  # 64
```

### اشتباه ۳: اشتباه گرفتن انواع تقسیم

```python
# تقسیم معمولی و صحیح اولویت یکسانی دارند
نتیجه = 10 / 3 * 3  # (10 / 3) * 3 = 10.0
print(نتیجه)  # 10.0

نتیجه = 10 // 3 * 3  # (10 // 3) * 3 = 9
print(نتیجه)  # 9
```

### اشتباه ۴: پرانتز گذاشتن در شرایط پیچیده

```python
# ❌ گیج‌کننده
سن = 20
کارت_دارد = True
نتیجه = سن >= 18 and کارت_دارد or سن >= 16
# آیا این یعنی: (سن >= 18 and کارت_دارد) or سن >= 16 ؟
# یا: سن >= 18 and (کارت_دارد or سن >= 16) ؟

# ✅ همیشه برای وضوح از پرانتز استفاده کنید
می‌تواند_وارد_شود = (سن >= 18 and کارت_دارد) or (سن >= 16 and not کارت_دارد)
```

---

## خودتان امتحان کنید: تمرین‌ها

### تمرین ۱: خروجی را حدس بزنید

قبل از اجرا، حدس بزنید هر کدام چه چیزی چاپ می‌کند:

```python
print(2 + 3 * 4)        # حدس شما: ___
print((2 + 3) * 4)      # حدس شما: ___
print(10 - 4 + 2)       # حدس شما: ___
print(10 - (4 + 2))     # حدس شما: ___
print(2 ** 2 ** 2)      # حدس شما: ___
print((2 ** 2) ** 2)    # حدس شما: ___
```

<details>
<summary>برای دیدن پاسخ کلیک کنید</summary>

```
14, 20, 8, 4, 16, 16
```
</details>

### تمرین ۲: پرانتز اضافه کنید

پرانتز اضافه کنید تا نتیجه با توضیحات مطابقت داشته باشد:

```python
# این را ۳۰ کنید (نه ۱۴)
نتیجه = 2 + 3 * 4

# این را ۲۰ کنید (نه ۱۴)
نتیجه = 10 - 2 * 3

# این را ۳۶ کنید (نه ۱۴)
نتیجه = 10 + 2 * 3 - 4
```

<details>
<summary>برای دیدن پاسخ کلیک کنید</summary>

```python
نتیجه = (2 + 3) * 4        # 30
نتیجه = (10 - 2) * 3       # 24 - صبر کنید، این 20 نیست!
# در واقع: نتیجه = 10 - 2 * 3 همیشه 4 است
# می‌خواهیم: 10 * 2 = 20، بعد چی؟
# شاید: نتیجه = (10 - 2) * (3 - 1)  # 16، هنوز 20 نیست
# بیایید امتحان کنیم: نتیجه = 10 * 2 - 3 * 0  # نه، این 20 است اما عبارت را تغییر می‌دهد
# در واقع این یک سوال ترفند ممکن است!

نتیجه = 10 + (2 * 3) - 4   # 12 - هنوز 36 نیست
# شاید: (10 + 2) * 3 = 36، پس - 4 چی؟
# (10 + 2) * (3 - 4) = -12
# هوم، شاید: (10 + 2) * 3 - 4 = 32
# در واقع، بیایید دوباره اصل را بررسی کنیم: 10 + 2 * 3 - 4 = 12
# برای 36: (10 + 2) * 3 = 36، پس... شاید -4 نباید اعمال شود؟
```
</details>

### تمرین ۳: ماشین‌حساب خرید با ترتیب واضح

برنامه‌ای برای محاسبه قیمت کل با مالیات بنویسید:

```python
# گرفتن ورودی
قیمت = float(input("قیمت کالا: $"))
تعداد = int(input("تعداد: "))
نرخ_مالیات = 0.08  # ۸٪

# محاسبه با ترتیب واضح
جمع_جزی = قیمت * تعداد
مالیات = جمع_جزی * نرخ_مالیات
مجموع = جمع_جزی + مالیات

print(f"جمع جزئی: ${جمع_جزی:.2f}")
print(f"مالیات (۸٪): ${مالیات:.2f}")
print(f"مجموع: ${مجموع:.2f}")

# جایگزین در یک خط (خواندن سخت‌تر!)
مجموع_یک_خط = قیمت * تعداد + قیمت * تعداد * نرخ_مالیات
print(f"\nمجموع یک‌خطی: ${مجموع_یک_خط:.2f}")
```

### تمرین ۴: رفع اشکالات

این برنامه خطا دارد. آن‌ها را پیدا و رفع کنید:

```python
# برنامه با اشکال
سن = input("سن خود را وارد کن: ")
بزرگسال_هست = سن > 18
print("می‌تواند رای دهد: " + سن >= 18)

# اشکال دیگر
مجموع = 100
tخفیف = 10
نهایی = مجموع - تخفیف / 100 * مجموع  # باید 90 باشد، اما نیست!
print(f"قیمت نهایی: ${نهایی}")
```

<details>
<summary>برای دیدن پاسخ کلیک کنید</summary>

```python
# برنامه رفع شده
سن = int(input("سن خود را وارد کن: "))  # تبدیل به عدد!
بزرگسال_هست = سن >= 18  # از >= برای "۱۸ یا بیشتر" استفاده کنید
print(f"می‌تواند رای دهد: {سن >= 18}")  # از f-string استفاده کنید یا bool را به رشته تبدیل کنید

# رفع تخفیف - نیاز به پرانتز
مجموع = 100
tخفیف = 10
نهایی = مجموع - (تخفیف / 100 * مجموع)  # حالا 90 است
# یا واضح‌تر:
مبلغ_تخفیف = مجموع * (تخفیف / 100)
نهایی = مجموع - مبلغ_تخفیف
print(f"قیمت نهایی: ${نهایی}")
```
</details>

---

## مرجع سریع

### ترتیب کامل عملیات

۱. `()` - پرانتز (همیشه اول!)
۲. `**` - توان (راست به چپ)
۳. `*`، `/`، `//`، `%` - ضرب، تقسیم، تقسیم صحیح، باقیمانده (چپ به راست)
۴. `+`، `-` - جمع، تفریق (چپ به راست)
۵. `==`، `!=`، `>`، `<`، `>=`، `<=` - مقایسه
۶. `not` - منطقی NOT
۷. `and` - منطقی AND
۸. `or` - منطقی OR

### ترفند حافظه: PEMDAS

**P**lease **E**xcuse **M**y **D**ear **A**unt **S**ally

(پرانتز، توان، ضرب/تقسیم، جمع/تفریق)

### قوانین طلایی

| قانون | مثال |
|--------|------|
| برای وضوح از پرانتز استفاده کنید | `(a + b) * c` |
| توان‌ها راست به چپ می‌روند | `2 ** 3 ** 2 = 2 ** 9 = 512` |
| هم‌سطح چپ به راست می‌رود | `10 - 5 + 2 = 7` |
| وقتی شک داشتید، پرانتز بگذارید | `(10 - 5) + 2` |

---

## نکات کلیدی

۱. **پایتون از PEMDAS پیروی می‌کند** مثل کلاس ریاضی
۲. **پرانتز همیشه برنده است**—از آن‌ها برای کنترل ترتیب و بهبود خوانایی استفاده کنید
۳. **توان‌ها راست به چپ**، بقیه در یک سطح چپ به راست
۴. **ریاضی قبل از مقایسه**، مقایسه قبل از منطقی
۵. **وقتی شک داشتید، پرانتز بگذارید**—کد واضح بهتر از کد پیچیده است
۶. **عبارت‌های پیچیده** را به چند مرحله بشکنید

---

## گام بعدی

حالا که ترتیب ارزیابی را درک کردید:
- یاد می‌گیرید چگونه با دستورات if/else تصمیم بگیرید
- برنامه‌هایی می‌نویسید که بر اساس شرایط واکنش متفاوتی نشان می‌دهند
- عملگرها و شرایط را ترکیب می‌کنید

