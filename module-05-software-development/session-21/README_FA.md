# جلسه ۲۱: پروژه کوچک ۱ – اسکریپت پردازش داده

## مرور جلسه

تبریک می‌گویم! بعد از ۲۰ هفته یادگیری، امروز فرصت دارید همه چیزهایی که یاد گرفته‌اید را برای ساخت اولین برنامه کامل پایتون خود اعمال کنید. برنامه‌ای برای پردازش داده خواهیم برنامه‌ریزی، طراحی، پیاده‌سازی و تست خواهیم کرد که متغیرها، ورودی/خروجی، شرط‌ها، حلقه‌ها، توابع، مدیریت فایل و مدیریت خطا را یکپارچه می‌کند. این پروژه capstone نشان می‌دهد که چگونه همه قطعات با هم برای حل مسائل واقعی ترکیب می‌شوند.

## اصطلاحات کلیدی

- **جمع‌آوری نیازها**: درک اینکه برنامه نیاز به چه کاری دارد
- **توسعه incremental**: ساخت ویژگی‌ها گام به گام
- **تست یکپارچگی**: اطمینان از اینکه همه قسمت‌ها با هم کار می‌کنند
- **تجربه کاربر (UX)**: برنامه چقدر آسان و بصری است
- **موارد edge**: ورودی‌ها یا موقعیت‌های غیرمعمول که برنامه باید مدیریت کند
- **بازسازی**: بهبود ساختار کد در حالی که عملکرد را حفظ می‌کند

## مرور پروژه

برنامه‌ای برای **دفتر نمرات دانش‌آموزان** خواهید ساخت که:
- داده‌های دانش‌آموزان را از یک فایل می‌خواند
- نمرات و آمار را محاسبه می‌کند
- فرمت‌های داده مختلف را مدیریت می‌کند
- رابط متنی ساده فراهم می‌کند
- مدیریت خطای مناسب شامل می‌شود

## مرحله برنامه‌ریزی

### تجزیه نیازها
۱. **ورودی**: خواندن نام دانش‌آموزان و نمرات از یک فایل متنی
۲. **پردازش**: محاسبه میانگین‌ها، نمرات حرفی، وضعیت قبول/رد
۳. **خروجی**: نمایش نتایج در گزارش قالب‌بندی شده
۴. **مدیریت خطا**: مدیریت فایل‌های گم شده، داده‌های نامعتبر و غیره
۵. **رابط کاربر**: سیستم منوی ساده برای عملیات مختلف

### فرمت داده
فایل ورودی (`grades.txt`):
```
Alice Johnson,85,92,78
Bob Smith,76,88,91
Charlie Brown,95,87,93
Diana Prince,82,79,85
```

## استراتژی پیاده‌سازی

### مرحله ۱: خواندن پایه فایل
با پایه شروع کنید - خواندن داده از یک فایل:

```python
def read_grades(filename):
    """خواندن داده دانش‌آموزان از فایل و بازگشت لیست دیکشنری‌ها"""
    students = []
    try:
        with open(filename, 'r') as file:
            for line in file:
                # تجزیه هر خط
                parts = line.strip().split(',')
                name = parts[0]
                scores = [int(score) for score in parts[1:]]
                students.append({'name': name, 'scores': scores})
    except FileNotFoundError:
        print(f"خطا: فایل {filename} یافت نشد")
        return []
    except ValueError:
        print("خطا: داده نمره نامعتبر در فایل")
        return []
    return students
```

### مرحله ۲: محاسبات نمره
توابع را برای پردازش داده اضافه کنید:

```python
def calculate_average(scores):
    """محاسبه میانگین لیست نمرات"""
    if not scores:
        return 0
    return sum(scores) / len(scores)

def get_letter_grade(average):
    """تبدیل میانگین عددی به نمره حرفی"""
    if average >= 90:
        return 'A'
    elif average >= 80:
        return 'B'
    elif average >= 70:
        return 'C'
    elif average >= 60:
        return 'D'
    else:
        return 'F'

def get_grade_status(average):
    """بازگشت وضعیت قبول/رد"""
    return "قبول" if average >= 60 else "رد"
```

### مرحله ۳: تولید گزارش
قالب‌بندی خروجی ایجاد کنید:

```python
def generate_report(students):
    """تولید و نمایش گزارش نمره"""
    if not students:
        print("داده دانش‌آموزان موجود نیست")
        return

    print("\n" + "="*50)
    print("گزارش نمرات دانش‌آموزان")
    print("="*50)
    print("<25")
    print("-" * 50)

    for student in students:
        avg = calculate_average(student['scores'])
        letter = get_letter_grade(avg)
        status = get_grade_status(avg)

        print("<25")

    # محاسبه آمار کلاس
    all_scores = [score for student in students for score in student['scores']]
    class_avg = calculate_average(all_scores)
    pass_count = sum(1 for s in students if calculate_average(s['scores']) >= 60)

    print("-" * 50)
    print("<25")
    print(f"دانش‌آموزان قبول: {pass_count}/{len(students)} ({pass_count/len(students)*100:.1f}%)")
```

### مرحله ۴: حلقه برنامه اصلی
رابط کاربر اضافه کنید:

```python
def main():
    """تابع برنامه اصلی"""
    filename = "grades.txt"

    while True:
        print("\nمنوی دفتر نمرات:")
        print("1. بارگذاری و نمایش نمرات")
        print("2. نمایش آمار کلاس")
        print("3. خروج")

        choice = input("انتخاب را وارد کنید (1-3): ").strip()

        if choice == '1':
            students = read_grades(filename)
            generate_report(students)
        elif choice == '2':
            students = read_grades(filename)
            if students:
                show_statistics(students)
        elif choice == '3':
            print("خداحافظ!")
            break
        else:
            print("انتخاب نامعتبر. لطفاً دوباره امتحان کنید.")

if __name__ == "__main__":
    main()
```

## تست و اشکال‌زدایی

### موارد تست
۱. **عملکرد عادی**: فایل معتبر با داده خوب
۲. **فایل گم شده**: وقتی grades.txt وجود ندارد چه اتفاقی می‌افتد؟
۳. **داده نامعتبر**: نمرات غیرعددی، خطوط خالی
۴. **فایل خالی**: اگر فایل وجود دارد اما خالی است؟
۵. **موارد edge**: دانش‌آموزان بدون نمره، نمرات بسیار بالا/پایین

### مسائل رایج
- مشکلات مسیر فایل
- خطاهای تبدیل نوع
- تقسیم بر صفر (لیست‌های نمره خالی)
- مسائل قالب‌بندی رشته

## ایده‌های بهبود

وقتی نسخه پایه کار کرد، در نظر بگیرید اضافه کردن:
- ذخیره گزارش‌ها در فایل
- مرتب‌سازی دانش‌آموزان بر اساس نمره
- جستجوی دانش‌آموزان فردی
- نمودارهای توزیع نمره
- اعتبارسنجی ورودی برای انتخاب‌های منو

## فرآیند توسعه

۱. **کوچک شروع کنید**: ابتدا خواندن فایل را کار کنید
۲. **به طور مکرر تست کنید**: کد خود را بعد از هر تغییر اجرا کنید
۳. **ویژگی‌ها را incremental اضافه کنید**: سعی نکنید همه چیز را یکباره بسازید
۴. **خطاها را graceful مدیریت کنید**: از بلوک‌های try/except استفاده کنید
۵. **قالب‌بندی را بهبود دهید**: خروجی را قابل خواندن و حرفه‌ای کنید

## خلاصه و چک لیست

### آنچه امروز پوشش دادیم
- ✅ برنامه‌ریزی یک برنامه کامل از نیازها
- ✅ یکپارچگی مفاهیم برنامه‌نویسی متعدد
- ✅ مدیریت فایل، توابع، حلقه‌ها و شرط‌ها
- ✅ مدیریت خطا و اعتبارسنجی ورودی کاربر
- ✅ استراتژی‌های تست و اشکال‌زدایی

### مهارت‌های کلیدی نشان داده شده
- تقسیم مسائل پیچیده
- استفاده از توابع برای سازماندهی کد
- مدیریت فایل‌ها و داده‌ها
- ایجاد رابط‌های کاربرپسند
- تست برای موارد edge

### takeaway کلیدی
برنامه‌نویسی درباره حل مسائل با ترکیب مفاهیم ساده در راه‌حل‌های قدرتمند است. شما اکنون برنامه‌ای کامل و مفید ساخته‌اید که می‌تواند واقعاً در کلاس استفاده شود!

## مراحل بعدی

جلسه نهایی ما همه چیزهایی که یاد گرفته‌ایم را مرور خواهد کرد و فرصتی برای کار روی یک پروژه شخصی به شما می‌دهد. همچنین راهنمایی برای ادامه سفر برنامه‌نویسی خود فراتر از این دوره دریافت خواهید کرد.

## ارتباط با یادگیری آینده

این پروژه مهارت‌هایی را نشان می‌دهد که برای نیاز خواهید داشت:
- **توسعه وب**: مدیریت داده‌های کاربر و تولید گزارش‌ها
- **تحلیل داده**: پردازش و تحلیل مجموعه داده‌ها
- **اتوماسیون**: نوشتن اسکریپت‌ها برای حل مسائل دنیای واقعی
- **توسعه نرم‌افزار**: برنامه‌ریزی، پیاده‌سازی و تست برنامه‌های بزرگ‌تر

## مطالعه بیشتر (اختیاری)

- "دوره تصادفی پایتون" نوشته اریک ماتس (فصل‌های پروژه)
- خودکارسازی کار خسته‌کننده با پایتون (فصل‌های ۸-۱۲ درباره فایل‌ها و داده‌ها)
- آموزش‌های Real Python درباره مدیریت فایل و پردازش داده